---
import { Image } from "astro:assets"
import type { ImageMetadata } from "astro";
import { Icon } from "astro-icon/components";

export interface Social {
    href: string;
    icon: string; // e.g. "simple-icons:linkedin" or "custom:dev"
    colorClass?: string;
}

export interface Role {
    text: string;
    colorClass?: string; // Optional override, otherwise uses card theme
}

interface Props {
    name: string;
    image: ImageMetadata;
    color?: "blue" | "orange";
    roles: Role[];
    bio: string[];
    socials: Social[];
}

const { name, image, color = "blue", roles, bio, socials } = Astro.props;

const borderColors = {
    blue: "group-hover:border-blue-500",
    orange: "group-hover:border-orange-500",
};

const hoverBorderColors = {
    blue: "hover:border-blue-500/30",
    orange: "hover:border-orange-500/30",
};

// Default role styles based on card color if not specified
const roleBaseStyles = {
    blue: "bg-blue-500/10 text-blue-400 border-blue-500/20",
    orange: "bg-orange-500/10 text-orange-400 border-orange-500/20",
    purple: "bg-purple-500/10 text-purple-400 border-purple-500/20", // Extra for overrides
};

const currentBorder = borderColors[color];
const currentHoverBorder = hoverBorderColors[color];

---

<div class={`bg-surface border border-white/10 rounded-2xl transition-colors group flex flex-col h-full overflow-hidden ${currentHoverBorder}`}>
    <div class="p-8 flex flex-col items-center text-center flex-grow">
        <div class={`w-32 h-32 rounded-full overflow-hidden mb-6 border-2 border-white/10 transition-colors ${currentBorder}`}>
            <Image 
                src={image} 
                alt={name} 
                class="w-full h-full object-cover"
            />
        </div>
        
        <h2 class="text-2xl font-bold text-white mb-2">{name}</h2>
        
        <div class="flex flex-wrap gap-2 justify-center mb-6">
            {roles.map(role => {
                const styleClass = role.colorClass || roleBaseStyles[color];
                return (
                    <span class={`px-3 py-1 text-xs font-mono rounded-full border ${styleClass}`}>
                        {role.text}
                    </span>
                );
            })}
        </div>

        <div class="text-gray-400 text-sm leading-relaxed space-y-4">
            {bio.map(paragraph => (
                <p>{paragraph}</p>
            ))}
        </div>
    </div>

    <div class="border-t border-white/5 p-6 flex justify-center gap-4 opacity-60 group-hover:opacity-100 transition-opacity bg-black/20">
        {socials.map(social => (
            <a href={social.href} target="_blank" rel="noopener noreferrer" class={`transition-transform hover:scale-110 ${social.colorClass || 'hover:text-white'}`}>
                {social.icon === "custom:dev" ? (
                    <div class="w-6 h-6 bg-white text-black font-bold text-[8px] flex items-center justify-center rounded leading-none border border-transparent hover:border-black">DEV</div>
                ) : (
                    <Icon name={social.icon} class="w-5 h-5" />
                )}
            </a>
        ))}
    </div>
</div>
