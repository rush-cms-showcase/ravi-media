---
import { Icon } from "astro-icon/components"

interface Step {
    number: number
    icon: string
    title: string
    description: string
    offset?: string
}

interface Props {
    id?: string
    badge: string
    title: string
    subtitle: string
    steps: Step[]
    primaryColor?: string
    columns?: 3 | 4
    variant?: "centered" | "corner"
    notice?: {
        icon: string
        text: string
        color?: string
    }
}

const {
    id = "como-funciona",
    badge,
    title,
    subtitle,
    steps,
    primaryColor = "primary",
    columns = 3,
    variant = "centered",
    notice
} = Astro.props

const gridCols = columns === 4 ? "md:grid-cols-4" : "md:grid-cols-3"
const stepSize = columns === 4 ? { width: "w-12 h-12", text: "text-xl" } : { width: "w-16 h-16", text: "text-2xl" }
const cornerStepSize = { width: "w-12 h-12", text: "text-xl" }
const iconSize = columns === 4 ? "w-6 h-6" : "w-8 h-8"
const padding = columns === 4 ? "p-6" : "p-8"
const titleSize = columns === 4 ? "" : "text-xl"
---

<section id={id} class="py-24 bg-surface relative overflow-hidden">
    <div class={`absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-${primaryColor}-500/5 blur-[120px] rounded-full pointer-events-none`}></div>

    <div class="container mx-auto px-4 relative z-10">
        <div class="text-center mb-16">
            <span class="inline-block px-4 py-1 bg-white/5 text-gray-400 text-sm font-mono rounded-full mb-4">
                {badge}
            </span>
            <h2 class="text-3xl lg:text-5xl font-bold mb-4">
                {title}
            </h2>
            <p class="text-gray-400 max-w-2xl mx-auto text-lg">
                {subtitle}
            </p>
        </div>

        <div class="max-w-5xl mx-auto">
            <div class={`grid ${gridCols} gap-8`}>
                {variant === "centered" ? (
                    steps.map((step) => (
                        <div class={`relative ${step.offset || ''}`}>
                            <div class={`bg-black border border-white/10 rounded-2xl ${padding} h-full hover:border-${primaryColor}-500/50 transition-colors text-center`}>
                                <div class={`${stepSize.width} bg-${primaryColor}-500 rounded-${columns === 4 ? 'xl' : '2xl'} flex items-center justify-center text-black font-bold ${stepSize.text} mx-auto mb-${columns === 4 ? '4' : '6'} shadow-lg shadow-${primaryColor}-500/20`}>
                                    {step.number}
                                </div>
                                <Icon name={step.icon} class={`${iconSize} text-gray-500 mx-auto mb-${columns === 4 ? '3' : '4'}`} />
                                <h4 class={`${titleSize} font-bold text-white mb-${columns === 4 ? '2' : '3'}`}>{step.title}</h4>
                                <p class={`text-gray-${columns === 4 ? '500' : '400'} text-${columns === 4 ? 'xs' : 'sm'} ${columns === 4 ? '' : 'leading-relaxed'}`}>
                                    {step.description}
                                </p>
                            </div>
                        </div>
                    ))
                ) : (
                    steps.map((step) => (
                        <div class={`relative ${step.offset || ''}`}>
                            <div class={`bg-black border border-white/10 rounded-2xl p-8 h-full hover:border-${primaryColor}/50 transition-colors`}>
                                <div class={`absolute -top-4 -left-4 ${cornerStepSize.width} bg-${primaryColor} rounded-xl flex items-center justify-center text-black font-bold ${cornerStepSize.text} shadow-lg shadow-${primaryColor}/20`}>
                                    {step.number}
                                </div>
                                <div class="pt-4">
                                    <Icon name={step.icon} class="w-8 h-8 text-gray-500 mb-4" />
                                    <h4 class="text-xl font-bold text-white mb-3">{step.title}</h4>
                                    <p class="text-gray-400 text-sm leading-relaxed">
                                        {step.description}
                                    </p>
                                </div>
                            </div>
                        </div>
                    ))
                )}
            </div>

            {notice && (
                <div class={`mt-16 p-6 bg-${notice.color || primaryColor}-900/10 border border-${notice.color || primaryColor}-500/20 rounded-2xl text-center max-w-3xl mx-auto flex items-center justify-center gap-4`}>
                    <Icon name={notice.icon} class={`w-6 h-6 text-${notice.color || primaryColor}-500`} />
                    <p class={`text-sm text-${notice.color || primaryColor}-200`}>
                        {notice.text}
                    </p>
                </div>
            )}
        </div>
    </div>
</section>
